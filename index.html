<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Space Shooter Pro</title>

<style>
  body {
    margin: 0;
    background: black;
    overflow: hidden;
    font-family: Arial, sans-serif;
    color: white;
    text-align: center;
  }

  #hud {
    display: flex;
    justify-content: space-around;
    padding: 10px;
  }

  #game {
    position: relative;
    width: 400px;
    height: 600px;
    margin: auto;
    border: 2px solid cyan;
    background: black;
    overflow: hidden;
  }

  /* Star background */
  .star {
    position: absolute;
    width: 2px;
    height: 2px;
    background: white;
  }

  #player {
    position: absolute;
    bottom: 10px;
    left: 180px;
    width: 40px;
    height: 40px;
    background: cyan;
    clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
  }

  .bullet {
    position: absolute;
    width: 4px;
    height: 12px;
    background: yellow;
  }

  .enemy {
    position: absolute;
    width: 40px;
    height: 40px;
    background: red;
    border-radius: 6px;
  }

  #gameOver {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.8);
    display: none;
    align-items: center;
    justify-content: center;
    flex-direction: column;
  }

  button {
    padding: 10px 20px;
    margin-top: 10px;
    font-size: 16px;
    cursor: pointer;
  }
</style>
</head>

<body>

<div id="hud">
  <div id="score">Score: 0</div>
  <div id="lives">❤️❤️❤️</div>
  <div id="highScore">High: 0</div>
</div>

<div id="game">
  <div id="player"></div>

  <div id="gameOver">
    <h2>GAME OVER</h2>
    <button onclick="restartGame()">Restart</button>
  </div>
</div>

<!-- Sounds -->
<audio id="shootSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_2b9f7f6ef6.mp3"></audio>
<audio id="boomSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_9f5b8d8f21.mp3"></audio>

<script>
const game = document.getElementById("game");
const player = document.getElementById("player");
const scoreText = document.getElementById("score");
const livesText = document.getElementById("lives");
const highScoreText = document.getElementById("highScore");
const gameOverScreen = document.getElementById("gameOver");

const shootSound = document.getElementById("shootSound");
const boomSound = document.getElementById("boomSound");

let playerX = 180;
let score = 0;
let lives = 3;
let enemySpeed = 2;
let spawnRate = 1200;
let gameOver = false;

let highScore = localStorage.getItem("highScore") || 0;
highScoreText.textContent = "High: " + highScore;

/* Player movement */
document.addEventListener("keydown", e => {
  if (gameOver) return;

  if (e.key === "ArrowLeft" && playerX > 0) playerX -= 20;
  if (e.key === "ArrowRight" && playerX < 360) playerX += 20;
  if (e.key === " ") shootBullet();

  player.style.left = playerX + "px";
});

/* Bullet */
function shootBullet() {
  shootSound.currentTime = 0;
  shootSound.play();

  const bullet = document.createElement("div");
  bullet.className = "bullet";
  bullet.style.left = playerX + 18 + "px";
  bullet.style.bottom = "50px";
  game.appendChild(bullet);

  const move = setInterval(() => {
    let y = parseInt(bullet.style.bottom);
    bullet.style.bottom = y + 10 + "px";

    if (y > 600) {
      bullet.remove();
      clearInterval(move);
    }

    document.querySelectorAll(".enemy").forEach(enemy => {
      if (isColliding(bullet, enemy)) {
        boomSound.currentTime = 0;
        boomSound.play();

        enemy.remove();
        bullet.remove();
        clearInterval(move);

        score++;
        scoreText.textContent = "Score: " + score;

        if (score % 5 === 0) {
          enemySpeed++;
          spawnRate = Math.max(400, spawnRate - 100);
        }
      }
    });
  }, 20);
}

/* Enemy */
function createEnemy() {
  if (gameOver) return;

  const enemy = document.createElement("div");
  enemy.className = "enemy";
  enemy.style.left = Math.random() * 360 + "px";
  enemy.style.top = "0px";
  game.appendChild(enemy);

  const move = setInterval(() => {
    let y = parseInt(enemy.style.top);
    enemy.style.top = y + enemySpeed + "px";

    if (isColliding(enemy, player)) {
      enemy.remove();
      clearInterval(move);
      loseLife();
    }

    if (y > 600) {
      enemy.remove();
      clearInterval(move);
    }
  }, 20);
}

/* Lives */
function loseLife() {
  lives--;
  livesText.textContent = "❤️".repeat(lives);

  if (lives <= 0) endGame();
}

/* Game over */
function endGame() {
  gameOver = true;
  gameOverScreen.style.display = "flex";

  if (score > highScore) {
    localStorage.setItem("highScore", score);
    highScoreText.textContent = "High: " + score;
  }
}

/* Restart */
function restartGame() {
  location.reload();
}

/* Stars */
function createStar() {
  const star = document.createElement("div");
  star.className = "star";
  star.style.left = Math.random() * 400 + "px";
  star.style.top = "0px";
  game.appendChild(star);

  const move = setInterval(() => {
    let y = parseInt(star.style.top);
    star.style.top = y + 3 + "px";

    if (y > 600) {
      star.remove();
      clearInterval(move);
    }
  }, 30);
}

/* Collision */
function isColliding(a, b) {
  const r1 = a.getBoundingClientRect();
  const r2 = b.getBoundingClientRect();
  return !(r1.right < r2.left || r1.left > r2.right || r1.bottom < r2.top || r1.top > r2.bottom);
}

/* Game loops */
setInterval(createEnemy, spawnRate);
setInterval(createStar, 100);
</script>

</body>
</html>
